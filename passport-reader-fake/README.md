# e-Passport NFC Reader for the BAC Unlinkablity attack

## Summary

This subfolder contains an implementation of the dishones e-passport reader that exploits BAC unlinkability vulnerability. This implementation is given in the form of an android app, that can run on any android phone with NFC support. The code is based on a open-source implementation of e-passport reader by Anton Tananaev ([https://github.com/tananaev/passport-reader](https://github.com/tananaev/passport-reader)) [Apache 2.0 License](https://www.apache.org/licenses/LICENSE-2.0).

## Dependencies

Note that the app includes following third party dependencies:

- JMRTD - [LGPL 3.0 License](https://www.gnu.org/licenses/lgpl-3.0.en.html) (modified)
- SCUBA (Smart Card Utils) - [LGPL 3.0 License](https://www.gnu.org/licenses/lgpl-3.0.en.html)
- Spongy Castle - MIT-based [Bouncy Castle Licence](https://www.bouncycastle.org/licence.html)
- Unidata Jj2000 - [Apache 2.0 License](https://www.apache.org/licenses/LICENSE-2.0)
- JNBIS - [Apache 2.0 License](https://www.apache.org/licenses/LICENSE-2.0)
- Material DateTimepicker - [Apache 2.0 License](https://www.apache.org/licenses/LICENSE-2.0)

## Library modifications

In order to change control flow of the BAC execution certain modifications to the JMRTD (version 0.5.5) library has been made:
1. Intruder interface class with the only function ```public byte[] sendOutChallenge(byte[] bytes);``` was added. Dishonest e-passport reader implements Intruder interface where NONCE is relayed, suspense for the response from fake-e-passport and returning execution flow to proxy APDU command to the honest e-passport.
2. ```public synchronized boolean doBACUnlinkabilityAttack(Intruder intruder) throws CardServiceException, GeneralSecurityException ``` and ```private synchronized boolean proxyCommand(byte[] data) throws CardServiceException``` functions were added to PassportService class. One has to pass previously explained implementation of Intruder to the doBACUnlinkabilityAttack function where reader sends GET_CHALLENGE to connected e-passport, sendOutChallenge is executed and returned APDU command is proxied back to e-passport by invoking proxyCommand function.  

Full source code can be found in subfolder "jmrtd_bac_modified".