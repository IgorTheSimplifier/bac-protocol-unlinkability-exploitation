# e-Passport NFC Passport for the BAC Unlinkablity attack
## Summary

This subfolder contains an implementation of the e-passport role in the BAC protocol that relays messages to external device. This implementation is given in the form of an android app, that can run on any android phone with NFC support. The code is based on a sample implementation given by Google ([https://github.com/googlesamples/android-CardEmulation](https://github.com/googlesamples/android-CardEmulation) ).

## Operation

In order to test the app, run the following steps

* Build the attached app in Android Studio
* Deploy the app to a suitable smartphone
* Launch the app, ensuring NFC is enabled on the phone
* Hit discover button, ensuring Wifi is enabled (doesn't have to be connect to the network), and select a fake passport you want to relay messages to.
* Bring the phone near to a e-passport reader (for example, the open source app given by ( [https://github.com/tananaev/passport-reader](https://github.com/tananaev/passport-reader) ) 

The app will then show a log of the BAC protocol between the phone (emulating a passport) and the reader. This log extends up to the last message sent by the reader (i.e. the command containing the encrypted and mac'ced keyshare and nonce confirmation).

In an attack scenario, this message would be forwarded to a remote reader device and then an "honest" passport. The response message from this passport would then demonstrate whether or not it is linked to the previously tracked session.

## Example

An example output the app is given in the screenshot below:

![Screenshot](../figs/bac_communication.png "Output of dishonest e-passport emulator implementation")

Note that as a response to the `GET_CHALLENGE` message we send a preloaded nonce (one that has been forwarded from an dishonest reader in advance before communication of current e-passport and honest reader). We later retrieve the encrypted packet with attached MAC that uses this nonce as part of the message.